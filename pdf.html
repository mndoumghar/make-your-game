<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders Game Implementation Overview</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e5e7eb; /* gray-200 */
        }
        .paper {
            width: 100%;
            max-width: 8.5in;
            min-height: 11in;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            font-weight: 700;
        }
        h2 {
            border-bottom: 2px solid #e5e7eb; /* gray-200 */
            padding-bottom: 8px;
            margin-top: 2rem;
        }
        h3 {
            margin-top: 1.5rem;
            font-weight: 500;
        }
        pre {
            font-family: 'Roboto Mono', monospace;
            background-color: #f3f4f6; /* gray-100 */
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 8px;
            padding: 1.5rem;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.4;
            color: #1f2937; /* gray-800 */
        }
        ul {
            list-style-position: inside;
        }
        li {
            margin-bottom: 0.5rem;
        }
        strong {
            font-weight: 500;
        }
        @media print {
            body {
                background-color: #fff;
            }
            .paper {
                box-shadow: none;
                margin: 0;
                max-width: 100%;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="paper bg-white mx-auto p-8 sm:p-12 text-gray-900">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800">Space Invaders Game Implementation Overview</h1>
            <p class="text-lg text-gray-500 mt-2">A Comprehensive Technical Document (Revision 2)</p>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Game Architecture and Flow -->
            <section>
                <h2 class="text-2xl font-bold mb-4">Game Architecture and Flow</h2>
                <p class="mb-6 text-gray-600">The game operates on a central loop driven by `requestAnimationFrame`. Each frame, the engine processes user input, updates all game entities, checks for collisions, and then renders the new state to the screen. This ensures a clean separation of concerns and smooth animation.</p>
                <pre>
+---------------------+
|     Game Loop       |
| (RequestAnimFrame)  |
+----------+----------+
           |
           v
+---------------------------------------------------+
|               (Update Game State)                 |
v                                                   v
+-------+--------+                           +--------+-------+
| Input Handler  |                           | Entity Updates |
+-------+--------+                           +--------+-------+
           |                                          |
           v                                          v
+-------+--------+                           +--------+-------+
| Player Control |                           | Bullet & Enemy |
+----------------+                           |    Movement    |
                                                      |
                  +------------------------------------+    |
                  |                                    |    |
                  v                                    v    v
           +------+-----+                       +--------+-------+
           | Game State |&lt;-------------------&gt;| Collision Check |
           +------+-----+                       +----------------+
                  |
                  v
           +------+------+
           | Render Scene|
           +-------------+
                </pre>
            </section>

            <!-- Core Components -->
            <section>
                <h2 class="text-2xl font-bold mb-4">Core Components</h2>

                <h3 class="text-xl">1. Game Engine & State</h3>
                <ul class="list-disc pl-5 mt-2 text-gray-700 space-y-2">
                    <li><strong>Game Loop</strong>: A single `requestAnimationFrame` loop calls `update()` and `draw()` functions, creating a consistent and performant cycle.</li>
                    <li><strong>Central State Object (`gameState`)</strong>: A single JavaScript object holds the state of the entire game, including player position, enemy grid position, and arrays for all active bullets and enemies. This makes data management clean and predictable.</li>
                </ul>

                <h3 class="text-xl">2. Entity Management</h3>
                 <ul class="list-disc pl-5 mt-2 text-gray-700 space-y-2">
                    <li><strong>Enemy Grid</strong>: Enemies are created dynamically and placed into a container styled with `display: grid`. The entire grid is moved as a single unit for efficiency.</li>
                    <li><strong><span class="bg-yellow-200 px-1 rounded">UPDATED:</span> Efficient Destruction</strong>: To preserve the grid formation, destroyed enemies are not removed from the DOM. Instead, their `opacity` is set to 0 via a CSS class (e.g., `.destroyed`). This makes them invisible but ensures they still occupy their space in the CSS Grid, preventing the layout from collapsing.</li>
                </ul>

                <h3 class="text-xl">3. <span class="bg-yellow-200 px-1 rounded">NEW:</span> Projectile System</h3>
                <ul class="list-disc pl-5 mt-2 text-gray-700 space-y-2">
                    <li><strong>Dynamic Creation</strong>: On a `click` event, a new bullet `div` is created and a corresponding object is pushed to the `gameState.bullets` array.</li>
                    <li><strong>State-Driven Updates</strong>: The main game loop iterates through the `gameState.bullets` array to update each bullet's position and check for collisions. This is more performant than using `setInterval` for each bullet.</li>
                    <li><strong>Lifecycle Management</strong>: Bullets are removed from the DOM and the `gameState.bullets` array when they either go off-screen or collide with an enemy.</li>
                </ul>
            </section>

            <!-- Collision Detection -->
            <section>
                <h2 class="text-2xl font-bold mb-4">Collision Detection System</h2>
                <p class="mb-6 text-gray-600">Collision detection runs every frame inside the main game loop. It uses the `getBoundingClientRect()` method to check for overlaps between bullet and enemy bounding boxes.</p>
                 <ul class="list-disc pl-5 mt-2 text-gray-700 space-y-2">
                    <li><strong>Logic</strong>: The system iterates through the active bullets array. For each bullet, it loops through the list of active (not destroyed) enemies to check for a collision.</li>
                    <li><strong>Outcome</strong>: On collision, the bullet is removed and the enemy is marked as destroyed.</li>
                </ul>
                <pre>
+-------------------------+
|   Collision Detection   |
| (Inside Game Loop)      |
+------------+------------+
             |
             v
+-------------------------+
| FOR each active bullet: |
|  FOR each active enemy: |
|   IF boxes overlap:     |
|    - Destroy Enemy      |
|    - Destroy Bullet     |
+-------------------------+
             |
             v
      +-------v-------+
      | Update State  |
      +---------------+
                </pre>
            </section>
        </main>

        <!-- Footer -->
        <footer class="text-center text-gray-400 mt-16 pt-4 border-t">
            <p>Space Invaders - Technical Overview | Page 1</p>
        </footer>
    </div>
    <div class="text-center my-4 no-print">
        <p class="text-gray-500">To save as a PDF, use your browser's print option (Ctrl+P or Cmd+P) and select "Save as PDF".</p>
    </div>

</body>
</html>
